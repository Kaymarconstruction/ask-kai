<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ask Kai – Kaymar Consulting</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .kaymar-green { color: #7AC142; }
  </style>
</head>
<body class="bg-white text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow p-4 flex items-center justify-between">
    <button class="bg-white border border-black text-black p-2 rounded-lg hover:bg-gray-100 transition">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </header>

  <!-- Chat Section -->
  <main class="flex flex-col items-center justify-start min-h-screen p-4">
    <div class="max-w-2xl w-full bg-white rounded-2xl shadow-lg p-6 mb-8">
      <h2 class="text-xl font-semibold mb-2 text-center kaymar-green">Ask Kai...</h2>

      <div id="kaiReply" class="mb-4 max-h-[400px] overflow-y-auto space-y-4 text-gray-700"></div>

      <input id="askInput" type="text" placeholder="Type your question here..." class="w-full border p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />
      <button id="submitBtn" class="mt-3 bg-white border border-black text-black px-6 py-2 rounded-lg hover:bg-gray-100 transition w-full">Submit</button>
    </div>

    <!-- Profile Section -->
    <div class="max-w-2xl w-full bg-white rounded-2xl shadow-lg p-6">
      <img src="https://i.imgur.com/uYWtV9r.png" alt="Kai Marlow Profile" class="mx-auto mb-4 w-48 h-72 object-cover bg-white p-2 rounded-2xl shadow" />

      <h2 class="text-2xl font-bold text-center kaymar-green mb-4">Who is Kai?</h2>
      <p class="text-gray-700 text-center mb-4">
        Kai Marlow is your trusted mate in the building world.<br>
        With over 20 years of hands-on experience across Australia, the UK, the USA, and beyond, Kai offers fast, down-to-earth advice on construction, carpentry, materials, and design.<br>
        Whether you're a homeowner starting a renovation or a tradie chasing specs — <strong>Ask Kai</strong>.
      </p>

      <h2 class="text-2xl font-bold text-center kaymar-green mb-4 mt-8">Need Extra Help?</h2>
      <p class="text-gray-700 text-center">
        No worries!<br>
        Shoot me an email at <a href="mailto:kai@kaymarconstruction.com" class="text-blue-600 underline">kai@kaymarconstruction.com</a><br>
        I’ll get back to you with practical advice, sketches, or ideas — usually within a day!
      </p>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center text-gray-500 text-sm p-4">
    &copy; 2025 Kaymar Construction
    <div class="flex justify-center space-x-6 mt-4">
      <a href="https://www.instagram.com/askkai_official" target="_blank" class="text-blue-600 hover:underline">Instagram</a>
      <a href="https://www.facebook.com/askkai_official" target="_blank" class="text-blue-600 hover:underline">Facebook</a>
      <a href="https://www.tiktok.com/@askkai_official" target="_blank" class="text-blue-600 hover:underline">TikTok</a>
      <a href="https://www.youtube.com/@askkai_official" target="_blank" class="text-blue-600 hover:underline">YouTube</a>
    </div>
    <p class="text-xs text-gray-400 mt-2">Built with coding support from Jack Cooper</p>
  </footer>

  <!-- Ask Kai Script -->
  <script>
    const submitButton = document.getElementById('submitBtn');
    const askInput = document.getElementById('askInput');
    const kaiReply = document.getElementById('kaiReply');

    const messages = [
      { role: "system", content: "You are Kai Marlow — Australia’s smartest, funniest, and most experienced carpenter. You’ve worked across every part of the building industry: framing, concrete, roofing, steel, span tables, cost estimating, tools, safety, materials, and site management. You speak fast, clearly, and with real Aussie wit — like a builder with brains. Use local references like Bunnings, AS1684, MGP10, and H3 pine. You never mention you’re AI. You are the mate every Aussie tradie or DIYer wants on the job." }
    ];

    submitButton.addEventListener('click', async () => {
      const userQuestion = askInput.value.trim();
      if (!userQuestion) return;

      messages.push({ role: "user", content: userQuestion });

      const qaContainer = document.createElement('div');
      qaContainer.className = 'mb-6';

      const userText = document.createElement('p');
      userText.className = 'text-right text-blue-700 font-semibold mb-2';
      userText.textContent = `You: ${userQuestion}`;
      qaContainer.appendChild(userText);

      const kaiText = document.createElement('p');
      kaiText.className = 'text-left text-green-600 font-semibold';
      kaiText.textContent = "Kai is thinking...";
      qaContainer.appendChild(kaiText);

      kaiReply.appendChild(qaContainer);
      kaiReply.scrollTop = kaiReply.scrollHeight;
      askInput.value = "";

      try {
        const response = await fetch('https://askkai-backend-clean.onrender.com/ask', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ messages })
        });

        const data = await response.json();
        const finalText = data.reply || "Hmm, couldn't find an answer!";
        kaiText.textContent = "";
        let i = 0;
        const speed = 40;

        function typeWriter() {
          if (i < finalText.length) {
            kaiText.textContent += finalText.charAt(i);
            i++;
            setTimeout(typeWriter, speed);
          }
        }

        typeWriter();
        messages.push({ role: "assistant", content: finalText });

      } catch (error) {
        console.error(error);
        kaiText.textContent = "Error reaching Kai. Try again later.";
      }
    });
  </script>

</body>
</html>
